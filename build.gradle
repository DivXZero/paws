apply plugin: 'cpp'

task wrapper(type: Wrapper) {
  gradleVersion = '2.13'
}

model {

  platforms {
    windows_x86 {
      architecture 'x86'
      operatingSystem 'windows'
    } /* windows_x86 */
  } /* platforms */

  toolChains {
    visualCpp(VisualCpp)
  } /* toolChains */

  components {

    paws_app(NativeExecutableSpec) {
      sources {
        cpp {
          source {
            srcDir 'components/src/app'
          } /* source */
          exportedHeaders {
            srcDir 'components/include/app'
          }
          lib library: "paws_core"
        } /* cpp */
      } /* sources */
      binaries.all {
        if(targetPlatform.operatingSystem.windows) {
          if(toolChain in VisualCpp) {
            cppCompiler.args '/EHsc', '/O2'
            linker.args '-mwindows', '/SUBSYSTEM:windows', '/ENTRY:mainCRTStartup'
          }
        }
      } /* binaries */
    } /* paws_app */

    paws_core(NativeLibrarySpec) {
      sources {
        cpp {
          source {
            srcDir 'components/src/core'
          } /* source */
          exportedHeaders {
            srcDir 'components/include/core'
          }
        } /* cpp */
      } /* sources */
    } /* paws_core */

    paws_web_core(NativeLibrarySpec) {
      sources {
        cpp {
          source {
            srcDir 'components/src/web_core'
          } /* source */
          exportedHeaders {
            srcDir 'components/include/web_core'
          }
          lib library: "paws_core"
        } /* cpp */
      } /* sources */
    } /* paws_web_core */

    all {
      targetPlatform 'windows_x86'
      sources {
        cpp {
          exportedHeaders {
            srcDir 'components/include'
          }
        } /* cpp */
      } /* sources */
    } /* all */

  } /* components */
} /* model */
